<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Speech Detection</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <div class="words" contenteditable>
  </div>

  <script>
    //å¦‚æœæ˜¯åœ¨prefixed interfaceä¸‹ï¼Œå‰‡window.SpeechRecognitionéœ€è¦å‰ç¶´è®ŠæˆwebkitSpeechRecognition
    window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const recognition = new SpeechRecognition();//å‰µå»ºä¸€å€‹æ–°SpeechRecognitionå°è±¡
    recognition.interimResults = true; //æ˜¯å¦å³æ™‚è½‰è­¯
    recognition.lang = 'en-US';//è¨­ç½®ç•¶å‰ çš„èªè¨€

    let p = document.createElement('p');//å‰µå»ºp element
    const words = document.querySelector('.words'); //ç²å– .words  
    words.appendChild(p);


    //result ç•¶èªéŸ³è­˜åˆ¥æœå‹™è¿”å›çµæœæ™‚è§¸ç™¼
    //transcript å·²è­˜åˆ¥å–®è©çš„è½‰éŒ„
    //isFinal è¡¨æ˜é€™å€‹çµæœæ˜¯æœ€çµ‚çš„

    //ç›£è½ result äº‹ä»¶ï¼Œè§¸ç™¼å°±å–å¾—å›å‚³å€¼
    recognition.addEventListener('result', e => {
      const transcript = Array.from(e.results)
        .map(result => result[0])
        .map(result => result.transcript)
        .join('');

      //æ›¿æ›æ–‡å­—=>å­—å…ƒå–ä»£
      const poopScript = transcript.replace(/poop|poo|shit|dump/gi, 'ğŸ’©');
      p.textContent = poopScript;


      //åˆ¤æ–·å¦‚æœå·²ç¶“å–çš„æœ€çµ‚çµæœï¼Œå°‡èªéŸ³è½‰æ›æˆæ–‡å­—è¼¸å‡ºæ–¼ç•«é¢ä¸Š
      if (e.results[0].isFinal) {
        p = document.createElement('p');
        words.appendChild(p);
      }
    });

    //ç›£è½endäº‹ä»¶ï¼Œä¸¦é‡æ–°è§¸ç™¼
    recognition.addEventListener('end', recognition.start);

    //å•Ÿå‹•
    recognition.start();

  </script>


</body>

</html>